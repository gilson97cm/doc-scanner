

<div class="container m-2">
  <div class="form-group">
    <button class="btn btn-primary" (click)="openCamera()" [disabled]="isCameraOpen">Camera</button>
    <button class="btn btn-info ml-2" (click)="openGallery()" [disabled]="isGalleryOpen">Gallery</button>
    <button class="btn btn-danger ml-2" (click)="downloadPdf()" [disabled]="captures.length <= 0" >Finish: {{ captures.length }}</button>
  </div>
</div>


<div class="container m-2" *ngIf="isCameraOpen">
  <div [hidden]="!hasDevices">
    <div class="row">
      <div class="form-group col-md-6">
        <label for="cameras">Camera</label>
        <select id="cameras" class="form-control" [value]="deviceSelected" (change)="onDeviceSelectChange($event.target.value)">
          <option value="">No Device Selected</option>
          <option *ngFor="let device of availableDevices" [value]="device.deviceId">{{device.label}}</option>
        </select>
        <span class="text-danger" *ngIf=" deviceCurrent.deviceId === '' ">Select a camera.</span>
      </div>
    </div>
    <div class="row">
     <div class="col-md-12">
     
      <div  *ngIf=" deviceCurrent.deviceId != '' ">
        <video
          [class.show]="!isCaptured"
          [class.hide]="isCaptured"
          #video
          id="video"
          [width]="WIDTH"
          [height]="HEIGHT"
          autoplay
        ></video>
        <canvas
          style="display: none;"
          [class.show]="isCaptured"
          [class.hide]="!isCaptured"
          #canvas
          id="canvas"
          [width]="WIDTH"
          [height]="HEIGHT"
        ></canvas>

        <div class="form-group" *ngIf="!isCaptured" >
          <button class="btn btn-primary" (click)="capture()">
            Snap Photo
          </button>
        </div>
      </div>
     </div>
    </div>
  </div>
  <ng-container *ngIf="hasPermission === false">
    <h2>You denied the camera permission, we can't scan anything without it. ðŸ˜ª</h2>
  </ng-container>
</div>

<div class="container m-2" *ngIf="isGalleryOpen">
  <div fxFlex="100" fxLayoutAlign="space-around" >
    <div #dropZone
         class="dropZone"
         [ngClass]="{'drop-hover': overZone}"
         (drop)="$event.preventDefault(); dropFile($event)"
         (dragleave)="$event.preventDefault(); overZone = false;"
         (dragover)="$event.preventDefault(); overZone = true;"
         (click)="hiddenInput.click()">
      <div fxLayout="column" fxFlex="100"  fxLayoutAlign="space-around" style="text-align: center">
        <span class="inner-text" style="margin-top: auto; text-align: center">Drop an image here, or click to upload</span>
        <mat-icon color="primary" class="cloud-icon" style="margin-bottom:auto; margin-top: 12px; font-size: 64px;">cloud_upload</mat-icon>
      </div>
    </div>
  </div>
  <input #hiddenInput type="file" (change)="loadFile($event)" style="display:none" accept="image/*">
  
</div>

<div class="container m-2">
  <div class="video-container">
  
    <ngx-doc-scanner 
    id="scanner"
    *ngIf="image"
    [file]="image"
    (editResult)="editResult($event)"
    (exitEditor)="exitEditor()"
    (error)="onError($event)"
    (processing)="editorState($event)"
    [config]="config">
  
  </ngx-doc-scanner>
  </div>
</div>

<div class="container m-4">
  <div class="container mt-4 text-center" id="images">
  </div>
</div>
