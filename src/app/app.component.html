

<div class="marg-top10 panel-body">
  <div class="clearfix">
    <!--BUTTONS  -->
   <div class="form-row">
    <div class="form-item">
 
      <button class="text-button marg-left-butt10 marg-top10 text-uppercase" (click)="openCamera()" 
      [disabled]="isEnabledButton">Camera</button>
      <button class="text-button marg-left-butt10 marg-top10 text-uppercase" (click)="openGallery()" 
      [disabled]="isEnabledButton">Gallery</button>
      <button class="text-button marg-left-butt10  marg-top10  red text-uppercase ng-scope" (click)="onCancel()" 
      *ngIf="!isEnabledCancel">Cancel</button>
      <button class="text-button marg-left-butt10 marg-top10 green text-uppercase ng-scope" (click)="downloadPdf()" 
      [disabled]="captures.length <= 0" >Create PDF with {{ captures.length }} images</button>
    </div>
  </div>
  <!-- END BUTTONS -->

  <!-- CAMERA -->
   <div class="form-row">
        <div class="form-item" *ngIf="isCameraOpen && !isEditing">
          <div [hidden]="!hasDevices">
            <div class="fl-grid-item-row">
              <div class="fl-grid-item fl-item-half">
                <label for="cameras" class="fl-grid-item-label ng-binding">Camera</label>
                <div class="fl-grid-field-wrapper">
                  <div class="fl-grid-field">
                    <select id="cameras" class="eq-validation-object ng-pristine ng-valid ng-valid-required ng-touched" [value]="deviceSelected" (change)="onDeviceSelectChange($event.target.value)">
                      <option value="">No Device Selected</option>
                      <option *ngFor="let device of availableDevices" [value]="device.deviceId" [selected] = "deviceSelected == '' && deviceSelectedTemp == device.deviceId">{{device.label }}</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
        
            <div class="fl-grid-item-row">
              <div class="fl-grid-field-wrapper">
              <div class="fl-grid-field"  *ngIf=" deviceCurrent.deviceId != '' ">
             <div class="form-row">
              <div class="form-item-right">
                <video
                [class.show]="!isCaptured"
                [class.hide]="isCaptured"
                #video
                id="video"
                width="100%"
                height="100%"
                autoplay
              ></video>
              <canvas
                style="display: none;"
                [class.show]="isCaptured"
                [class.hide]="!isCaptured"
                #canvas
                id="canvas"
                [width]="WIDTH"
                [height]="HEIGHT"
              ></canvas>
              </div>
              <div class="form-item-last">
                <button class="text-button marg-top10 text-uppercase" (click)="capture()">
                 <i class="fa fa-camera fa-2x"></i>&nbsp;Take Photo
                </button>
              </div>
             </div>
             
              </div>
             </div>
            </div>
          </div>
          <ng-container *ngIf="hasPermission === false">
            <h2>You denied the camera permission, we can't scan anything without it. ðŸ˜ª</h2>
          </ng-container>
        </div>
   </div>
  <!-- END CAMERA -->

    <!-- GALLERY -->
    <div class="form-row">
      <div class="form-item" *ngIf="isGalleryOpen">
        <div class="fl-grid-field-wrapper file-input-wrapper">
          <input type="text" id="filename" name="filename" class="file-input-textbox" readonly="readonly" ng-class="{'error-field' : ctrl.uploadedFile.id == null &amp;&amp; ctrl.form.$submitted &amp;&amp; (ctrl.form.$invalid) }">
  
          <button class="text-button-file-input" id="fileInputButton">Select File</button>
          <input type="file" name="filename3" id="filename3" (change)="selectFile($event)"  eq-choose-file-drct="" accept="" data-changed="ctrl.upload(files)" ng-disabled="ctrl.isFileUploading" onchange="document.getElementById('filename').value = this.value" onmouseover="document.getElementById('fileInputButton').className='text-button-file-input';" onmouseout="document.getElementById('fileInputButton').className='text-button-file-input';" class="ng-isolate-scope">
      </div>
      </div>
    </div>
    <!-- END GALLERY -->

  <!-- EDITOR -->
  <div class="form-row" >
    <div class="form-item">
      <div class="fl-grid-item-row">
       <div class="form-row">
        <div class="form-item">
          <h2 class="marg-left10" *ngIf="captureEditing != null">Editing image {{ captureEditing.position }} of {{ captures.length }}</h2>
        </div>
       </div>
      </div>
      <div class="fl-grid-item-row">
        <div class="fl-grid-item fl-item-half">
          <ngx-doc-scanner 
          id="scanner"
          *ngIf="image && isEditing"
          [file]="image"
          (editResult)="editResult($event)"
          (exitEditor)="exitEditor()"
          (error)="onError($event)"
          (processing)="editorState($event)"
          [config]="config">
        </ngx-doc-scanner>
        </div>
      </div>
      <div class="fl-grid-item-row fl-item-wrapper " *ngIf="image && isEditing">
        <button class="text-button" (click)="actionClick(!doneCrop ? EXIT : BACK)">
          <i class="fa fa-arrow-left fa-2x"></i>&nbsp;{{ !doneCrop ? 'Exit' : 'Back' }}
        </button>
        <button class="text-button marg-left10" (click)="actionClick(!doneCrop ? ROTATE : FILTER )">
          <i class="fa fa-{{ !doneCrop ? 'rotate-right' : 'image'}} fa-2x"></i>&nbsp;{{ !doneCrop ? 'Rotate Right' : 'Filter' }}
        </button>
        <button class="text-button marg-left10 {{ doneCrop && 'green' }}" (click)="actionClick(!doneCrop ? DONE_CROP : UPLOAD)">
          <i class="fa fa-{{ !doneCrop ? 'check':'floppy-o' }} fa-2x"></i>&nbsp;{{ !doneCrop ? 'Done' : 'Save' }}
        </button>
      </div>
    </div>
  </div>
  <!-- END EDITOR -->

 <!-- IMAGES LIST -->
 <div *ngIf="captures.length > 0">
    <!-- <h1>List Of Images</h1> -->
    <button class="text-button  marg-top10  red" (click)="deleteAllImages()">
      <i class="fa fa-trash fa-2x"></i>&nbsp;Delete All Images
    </button>
    <button class="text-button marg-left-butt10  marg-top10" (click)="downloadAllImages()">
      <i class="fa fa-download fa-2x"></i>&nbsp;Download All Images
    </button>
    <div #dropListContainer class="form-row example-container " cdkDropListGroup  >
      <figure cdkDropList
              [cdkDropListData]="i"
              *ngFor="let capture of captures; let i = index" 
              class="form-item example-box">
        <img 
        cdkDrag
        [cdkDragData]="i"
        (cdkDragEntered)="dragEntered($event)"
        (cdkDragMoved)="dragMoved($event)"
        (cdkDragDropped)="dragDropped($event)"
        [class]="captureEditing?.id == capture.id && 'image-editing'" 
        [src]="capture.safeUrl" 
        [id]="capture.id" 
        alt="image" 
        class="img-captures "> 
        <span class="span-captures">{{ i+1 }}/{{ captures.length }} </span>
        <div>
          <button class="general-button  marg-top10  red" (click)="deleteImage(capture)">
            <i class="fa fa-trash fa-2x"></i>
          </button>
          <button class="general-button marg-left-butt10  marg-top10" (click)="editImage(capture)">
            <i class="fa fa-pencil fa-2x"></i>
          </button>
          <button class="general-button marg-left-butt10  marg-top10" (click)="downloadImage(capture)">
            <i class="fa fa-download fa-2x"></i>
          </button>
        </div>
      </figure>
    </div> 
 </div>
   
<!-- END IMAGES LIST -->
  </div>
</div>






